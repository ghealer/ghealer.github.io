<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>欲辨已忘言 - 不以物喜，不以己悲，心灵淡然若水，人生如行云流水，自在，安详</title><meta name="description" content="技术 | 安全 | 渗透 | 极客"><meta name="keywords" content="技术 | 安全 | 渗透 | 极客"><meta name="author" content="路边的野花"><meta name="copyright" content="路边的野花"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="website"><meta property="og:title" content="欲辨已忘言"><meta property="og:url" content="http://yoursite.com/"><meta property="og:site_name" content="欲辨已忘言"><meta property="og:description" content="技术 | 安全 | 渗透 | 极客"><meta property="og:image" content="http://yoursite.com/img/avatar.png"><meta property="article:published_time" content="2020-08-11T08:56:29.586Z"><meta property="article:modified_time" content="2020-08-11T08:56:29.586Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2020-08-11 16:56:29'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(http://cdn.lxyy.top/1.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">欲辨已忘言</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">欲辨已忘言</h1><div id="site_subtitle"><span id="subtitle"></span></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/08/05/hello-world/" title="Hello World">     <img class="post_bg" data-lazy-src="/img/art/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/08/05/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-05T08:05:22.981Z" title="发表于 2020-08-05 16:05:22">2020-08-05</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo generate

More info: Generating
Deploy to remote sites1$ hexo deploy

More info: Deployment
</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/06/10/fluff/" title="ROP Emporium の fluff">     <img class="post_bg" data-lazy-src="/img/art/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ROP Emporium の fluff"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/10/fluff/" title="ROP Emporium の fluff">ROP Emporium の fluff</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-10T01:35:57.000Z" title="发表于 2020-06-10 09:35:57">2020-06-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/WriteUPs/">WriteUPs</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/WriteUPs/ROP-Emporium/">ROP Emporium</a></span></div><div class="content">Introduction&emsp;&emsp;ROP Emporium训练5：fluff的解析。


fluff32Step 1&emsp;&emsp;程序正常运行截图：
&emsp;&emsp;checksec：
Step 2&emsp;&emsp;依然是pwnme中fgets函数存在溢出：
&emsp;&emsp;虽然程序中有system函数，但是没有可利用的字符串：
&emsp;&emsp;所以需要向内存中写入需要的字符串，再找一下可以实现目标的指令段：
&emsp;&emsp;也没有可以利用的指令段，似乎陷入死局？
Step 3&emsp;&emsp;其实还是有一条路可以走的，在XMAN level3 の Write-Up中我们通过泄露writes函数在got表上的地址得到libc的基地址，然后通过libc中的字符串getshell。这里我们依然可以使用ret2libc技术，泄露puts函数在got表上的地址，获取libc的基地址，然后用这个基地址加上’/bin/sh’在libc中的offset，调用system函数getshell。
&emsp;&emsp;但是根据题目的叙 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/05/01/AssembleCommand/" title="汇编指令长度">     <img class="post_bg" data-lazy-src="/img/art/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="汇编指令长度"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/01/AssembleCommand/" title="汇编指令长度">汇编指令长度</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-01T04:19:01.000Z" title="发表于 2020-05-01 12:19:01">2020-05-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Tools/">Tools</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Tools/Assembler/">Assembler</a></span></div><div class="content">&emsp;&emsp;不断完善中！！！


没有操作数的指令
指令长度为1个字节，如：pop rax

操作数只涉及寄存器的的指令
指令长度为2个字节，如：mov bx,ax

操作数涉及内存地址的指令
指令长度为3个字节，如：mov ax,ds:[bx+si+idata]

操作数涉及立即数的指令
指令长度为：寄存器类型+1

8位寄存器，寄存器类型=1，如：mov al,8；指令长度为2个字节

16位寄存器，寄存器类型=2，如：mov ax,8；指令长度为3个字节


跳转指令段内跳转
指令长度为2个字节或3个字节，jmp指令本身占1个字节

段内短转移，8位位移量占一个字节，加上jmp指令一个字节，整条指令占2个字节，如：jmp short opr

段内近转移，16位位移量占两个字节，加上jmp指令一个字节，整条指令占3个字节如：jmp near ptr opr


断间跳转
指令长度为5个字节，如：jmp dword ptr table[bx][di]，或 jmp far ptr opr，或 jmp dword ptr opr

inc指令
占用一个字节

push指令
 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">路边的野花</div><div class="author-info__description">技术 | 安全 | 渗透 | 极客</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">3</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">3</div></a></div><div class="card-info-data-item is-center"><a href="/categories"><div class="headline">分类</div><div class="length_num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ghealer"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">暂时没有</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a class="aside-post-cover" href="/2020/08/05/hello-world/" title="Hello World"><img class="aside-post-bg" data-lazy-src="/img/art/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2020/08/05/hello-world/" title="Hello World">Hello World</a><time class="aside-post_meta post-meta-date" datetime="2020-08-05T08:05:22.981Z" title="发表于 2020-08-05 16:05:22">2020-08-05</time></div></div><div class="aside-recent-post"><a class="aside-post-cover" href="/2020/06/10/fluff/" title="ROP Emporium の fluff"><img class="aside-post-bg" data-lazy-src="/img/art/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ROP Emporium の fluff"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2020/06/10/fluff/" title="ROP Emporium の fluff">ROP Emporium の fluff</a><time class="aside-post_meta post-meta-date" datetime="2020-06-10T01:35:57.000Z" title="发表于 2020-06-10 09:35:57">2020-06-10</time></div></div><div class="aside-recent-post"><a class="aside-post-cover" href="/2020/05/01/AssembleCommand/" title="汇编指令长度"><img class="aside-post-bg" data-lazy-src="/img/art/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="汇编指令长度"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2020/05/01/AssembleCommand/" title="汇编指令长度">汇编指令长度</a><time class="aside-post_meta post-meta-date" datetime="2020-05-01T04:19:01.000Z" title="发表于 2020-05-01 12:19:01">2020-05-01</time></div></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Tools/"><span class="card-category-list-name">Tools</span><span class="card-category-list-count">1</span></a></li><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Tools/Assembler/"><span class="card-category-list-name">Assembler</span><span class="card-category-list-count">1</span></a></li></ul><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/WriteUPs/"><span class="card-category-list-name">WriteUPs</span><span class="card-category-list-count">1</span></a></li><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/WriteUPs/ROP-Emporium/"><span class="card-category-list-name">ROP Emporium</span><span class="card-category-list-count">1</span></a></li></ul>
                       
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/PWN/" style="font-size: 16px; color: #999">PWN</a> <a href="/tags/Reverse/" style="font-size: 16px; color: #999">Reverse</a> <a href="/tags/Updating/" style="font-size: 16px; color: #999">Updating</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/08/"><span class="card-archive-list-date">八月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/06/"><span class="card-archive-list-date">六月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/05/"><span class="card-archive-list-date">五月 2020</span><span class="card-archive-list-count">1</span></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">3</div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 路边的野花</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><div class="js-pjax"><script>function subtitleType () {
  if (false) { 
    var typed = new Typed("#subtitle", {
      strings: "不乱于心，不困于情。不畏将来，不念过往。如此，安好!,深谋若谷，深交若水。深明大义，深悉小节。已然，静舒!,善宽以怀，善感以恩。善博以浪，善精以业。这般，最佳!,勿感于时，勿伤于怀。勿耽美色，勿沉虚妄。从今，进取!,无愧于天，无愧于地。无怍于人，无惧于鬼。这样，人生!".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: false,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '不乱于心，不困于情。不畏将来，不念过往。如此，安好!'
  }
}

if (false) {
  if (typeof Typed === 'function') subtitleType()
  else $.getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js', subtitleType)
} else {
  subtitleType()
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>